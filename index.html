<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="https://bafybeiceo34zauhu2y7jsu425tlkbj3lg7po4yqfj43kgj5dahbec6j6ae.ipfs.w3s.link/Basebunny.png" type="image/png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Claim 1M FAIR - BaseBunny</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      padding: 40px 20px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0052FF, #66B2FF);
      color: white;
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.2rem;
    }

    h2 {
      font-weight: 400;
      font-size: 1.1rem;
      margin-top: 0;
      margin-bottom: 1.5rem;
      color: #d0e9ff;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    button {
      background-color: #0052FF;
      border: none;
      color: white;
      padding: 14px 28px;
      font-size: 1.1rem;
      border-radius: 10px;
      cursor: pointer;
      margin: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #003fbb;
    }

    #status, #walletAddress, #countdown {
      font-size: 1rem;
      margin-top: 10px;
    }

    #status { color: #ffd700; }
    #walletAddress { color: #bbf1ff; }
    #countdown { color: #ffffff; font-size: 1.2rem; }

    #claimChart {
      margin: 40px auto 0 auto;
      display: block;
      max-width: 250px;
    }

    #claimCount {
      margin-top: 12px;
      font-size: 1rem;
      color: #ffffff;
    }

    footer {
      margin-top: 40px;
      font-size: 0.9rem;
    }

    a {
      color: #ffd700;
      text-decoration: underline;
    }
  </style>
</head>
<body style="margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #0052FF, #66B2FF); color: white;">
  <header style="text-align: center; margin-top: 40px;">
    <h1 style="font-size: 2.5rem; margin-bottom: 0.2rem;">Claim Your 1M BUNNY Tokens with BaseBunny üê∞</h1>
    <h2 style="font-weight: 400; font-size: 1.1rem; margin: 10px auto 30px auto; color: #d0e9ff; max-width: 700px;">BaseBunny is a fun and transparent token drop on Base. Every wallet can purchase 1M BUNNY tokens for 0.004 ETH. This is a one-time opportunity per wallet ‚Äî no bots, no whales, just fairness.</h2>
  </header>
  
  <div style="display: flex; justify-content: center; align-items: flex-start; gap: 40px; margin-top: 30px; flex-wrap: wrap;">
  <div>
    <img src="https://bafybeiceo34zauhu2y7jsu425tlkbj3lg7po4yqfj43kgj5dahbec6j6ae.ipfs.w3s.link/Basebunny.png" alt="BaseBunny" style="width: 300px; border-radius: 24px; box-shadow: 0 8px 24px rgba(0,0,0,0.3); opacity: 0.95;">
  </div>
  <div>
    <button id="connectBtn" onclick="connectWallet()">Connect Wallet</button>
    <div id="walletAddress"></div>
    <button onclick="claimTokens()">Pay 0.004 ETH & Claim 1M FAIR</button>
    <div id="countdown"></div>
    <div id="status"></div>
  </div>
  <div>
    <canvas id="claimChart" width="220" height="220"></canvas>
    <p id="claimCount" style="font-size: 1rem; color: #ffffff;"></p>
  </div>
</div>

  
  

  <script>
    const claimContractAddress = "0xd5f8e55443effded888bfc5543d5169ca52ff822";
    const tokenAddress = "0xdc3e3fa829354d84f0963020a593542bab7c6b2b";

    const claimAbi = [
      "function claim() external payable",
      "function claimed(address) view returns (bool)",
      "function deadline() view returns (uint256)"
    ];

    let provider;
    let signer;
    let contract;

    async function connectWallet() {
      const baseChainId = "0x2105";
      const currentChainId = await window.ethereum.request({ method: "eth_chainId" });
      if (currentChainId !== baseChainId) {
        try {
          await window.ethereum.request({
            method: "wallet_switchEthereumChain",
            params: [{ chainId: baseChainId }]
          });
        } catch (switchError) {
          document.getElementById("status").innerText = "Please switch to Base network.";
          return;
        }
      }
      if (window.ethereum) {
        try {
          await window.ethereum.request({ method: "eth_requestAccounts" });
          provider = new ethers.providers.Web3Provider(window.ethereum);
          signer = provider.getSigner();
          contract = new ethers.Contract(claimContractAddress, claimAbi, signer);
          const address = await signer.getAddress();
          document.getElementById("status").innerText = "Wallet connected";
          document.getElementById("walletAddress").innerText = address;
          document.getElementById("connectBtn").innerText = "Wallet Connected";
          await updateChart();
        } catch (err) {
          // document.getElementById("status").innerText = "Connection failed";
        }
      } else {
        document.getElementById("status").innerText = "MetaMask not detected";
      }
    }

    async function claimTokens() {
      if (!contract) {
        document.getElementById("status").innerText = "Please connect your wallet first to claim BUNNY.";
        return;
      }

      try {
        const address = await signer.getAddress();
        const hasClaimed = await contract.claimed(address);
        if (hasClaimed) {
          document.getElementById("status").innerText = "You have already claimed your BUNNY tokens.";
          return;
        }

        const deadline = await contract.deadline();
        const now = Math.floor(Date.now() / 1000);
        if (now > deadline) {
          document.getElementById("status").innerText = "Claim period has ended.";
          return;
        }

        const tx = await contract.claim({ value: ethers.utils.parseEther("0.004") });
        document.getElementById("status").innerText = "Claiming...";
        await tx.wait();
        document.getElementById("status").innerText = "Success! 1M BUNNY tokens claimed.";
      } catch (error) {
        console.error(error);
        // document.getElementById("status").innerText = "Transaction failed.";
      }
    }

    const deadlineUnix = Math.floor(Date.now() / 1000) + (10 * 24 * 60 * 60);

    function updateCountdown() {
      const now = Math.floor(Date.now() / 1000);
      let remaining = deadlineUnix - now;
      if (remaining <= 0) {
        document.getElementById("countdown").innerText = "‚è≥ Claim period has ended.";
        return;
      }

      const days = Math.floor(remaining / (60 * 60 * 24));
      remaining %= 60 * 60 * 24;
      const hours = Math.floor(remaining / (60 * 60));
      remaining %= 60 * 60;
      const minutes = Math.floor(remaining / 60);
      const seconds = remaining % 60;

      document.getElementById("countdown").innerText = `‚è≥ Ends in ${days}d ${hours}h ${minutes}m ${seconds}s`;
    }

    setInterval(updateCountdown, 1000);

    let totalClaimed = 0;

    async function updateChart() {
      try {
        const balance = await provider.getBalance(claimContractAddress);
        const ethReceived = parseFloat(ethers.utils.formatEther(balance));
        totalClaimed = Math.floor(ethReceived / 0.004);
      } catch (e) {
        totalClaimed = 0;
      }

      const data = {
        labels: ['Claimed', 'Remaining'],
        datasets: [{
          label: 'Token Claims',
          data: [totalClaimed, 900 - totalClaimed],
          backgroundColor: ['#FFD700', '#003366'],
        }]
      };

      new Chart(
        document.getElementById('claimChart'),
        {
          type: 'doughnut',
          data: data,
          options: {
            plugins: {
              legend: {
                labels: {
                  color: 'white'
                }
              }
            }
          }
        }
      );
      document.getElementById("claimCount").innerText = `${totalClaimed} wallets have claimed so far.`;
    }

    window.addEventListener('load', async () => {
      provider = new ethers.providers.JsonRpcProvider("https://mainnet.base.org");
      await updateChart();
    });
  </script>

  <footer style="margin-top: 40px; font-size: 0.9rem;">
    Follow us on <a href="https://x.com/yourusername" target="_blank">
      <img src="https://abs.twimg.com/icons/apple-touch-icon-192x192.png" alt="X" style="width: 20px; height: 20px; vertical-align: middle;"> X (Twitter)
    </a>
  </footer>
</body>
</html>
